<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Aircrash Deep Dive</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <div class="container">
    <h1>Aircrash Explorer â€“ Deep Dive</h1>

    <!-- New filter form -->
    <form method="get" action="/digdeep">
      <label for="type">Filter by Accident Type:</label>
      <select name="type" onchange="this.form.submit()" class="multiline-dropdown">
        <option value="All" {% if selected_type=='All' %}selected{% endif %}>All</option>
        {% for t in accident_types %}
          {% if t.strip() %}
            <option value="{{ t }}" {% if selected_type==t %}selected{% endif %}>{{ t }}</option>
          {% endif %}
        {% endfor %}
      </select>
    </form>

    <hr style="margin: 40px 0;">

    <h2>Accidents Per Year</h2>
    <div>
      {{ line_html | safe }}
    </div>

    <hr style="margin:40px 0;">

    <h2>Top 5 Cause Categories by Total Fatalities</h2>
    <div>
      {{ bar_html | safe }}
    </div>

    <hr style="margin:40px 0;">

    <!-- new choropleth block -->
    <h2>Pilot-Induced Crashes by State</h2>
    <div>
      {{ choropleth_html | safe }}
    </div>

    <!-- after your choropleth block -->
    <hr style="margin:40px 0;">
    <h2>Pilot-Induced Crash Hot-Spots</h2>
    <div>
      {{ heatmap_html | safe }}
    </div>

      <hr style="margin: 40px 0;">
      <h2>Pilot Qualification Breakdown (Pilot-Induced Crashes)</h2>
      <p>This chart shows how crashes are distributed based on the qualification of pilots when the cause was pilot-induced.</p>
      <div>
         {{ pilot_html | safe }}
      </div>
      <hr style="margin: 40px 0;">
<h2>Pilot-Induced Crashes: Day vs Night</h2>
<p>Compare crashes during daytime and nighttime where cause was pilot-induced.</p>
<div>
  {{ daynight_html | safe }}
</div>

      <hr style="margin: 40px 0;">
<h2>2-Gram Word Cloud of Accident Types</h2>
<p>Most common word pairs in the accident_type column.</p>
<img src="data:image/png;base64,{{ wordcloud_img }}" alt="2-gram Word Cloud" style="width: 100%; max-width: 800px;">
      <hr style="margin: 40px 0;">
<h2>Pilot Age Histogram</h2>
<p>Select binning method to see how pilot age distribution changes.</p>
<div>
  {{ age_hist_html | safe }}
</div>
  </div>
</body>