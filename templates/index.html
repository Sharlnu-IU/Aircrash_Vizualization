<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Aircrash Explorer</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

  <!-- Sticky header -->
  <header id="site-header">
    <div class="header-inner">
      <h1>Aircrash Explorer</h1>
      <div class="header-controls">
        <button id="theme-toggle">ðŸŒ™</button>
        <nav>
          <a href="{{ url_for('index') }}">Home</a>
          <a href="{{ url_for('digdeep') }}">Deep Dive</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Fadeâ€in wrapper for globe -->
    <div class="globe-wrapper fade-in">
      {{ plot_html|safe }}
    </div>

    <!-- Fadeâ€in wrapper for button -->
    <div class="fade-in" style="text-align:center; margin:20px 0;">
      <a href="{{ url_for('digdeep') }}">
        <button class="btn">Deep Dive: Into the Rabbit Hole âŸ¶</button>
      </a>
    </div>
  </div>

  <!-- Dark-mode toggle & scroll animation script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const toggle = document.getElementById('theme-toggle');
      // 1) Default to dark unless the user explicitly chose light
      let theme = localStorage.getItem('theme') || 'dark';
      if (theme === 'dark') {
        document.body.classList.add('dark-mode');
        toggle.textContent = 'â˜€ï¸';
      } else {
        document.body.classList.remove('dark-mode');
        toggle.textContent = 'ðŸŒ™';
      }
      // 2) Toggle handler
      toggle.addEventListener('click', () => {
        const isDark = document.body.classList.toggle('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        toggle.textContent = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
      });
      // 3) Fade-in observer
      const io = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            e.target.classList.add('visible');
            io.unobserve(e.target);
          }
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.fade-in').forEach(el => io.observe(el));
    });
  </script>

</body>

</html>
